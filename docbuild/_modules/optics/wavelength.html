
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>optics.wavelength &#8212; Ray Optics  documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for optics.wavelength</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Set of classes to deal with optical wavelengths and functions associated with </span>
<span class="sd">wavelengths including refractive index and spectra.  It aslo handles the default wavelength of the package.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">getenv</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">plot</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">vector</span> <span class="kn">import</span> <span class="n">Vector2d</span><span class="p">,</span><span class="n">Vector3d</span>
<span class="kn">from</span> <span class="nn">optics.material</span> <span class="kn">import</span> <span class="n">MaterialData</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>


<span class="n">Blue</span> <span class="o">=</span> <span class="mf">0.460</span>        <span class="c1">#: Blue in microns</span>
<span class="n">Green</span> <span class="o">=</span> <span class="mf">0.55</span>        <span class="c1">#: Green in microns</span>
<span class="n">Red</span> <span class="o">=</span> <span class="mf">0.65</span>          <span class="c1">#: Red in microns</span>
<span class="n">TriColour</span> <span class="o">=</span> <span class="p">(</span><span class="n">Red</span><span class="p">,</span><span class="n">Green</span><span class="p">,</span><span class="n">Blue</span><span class="p">)</span>
<span class="n">BlueLimit</span> <span class="o">=</span> <span class="mf">0.35</span>    <span class="c1">#: Visual Blue limit</span>
<span class="n">RedLimit</span> <span class="o">=</span> <span class="mf">0.7</span>      <span class="c1">#: Visual Read Limit</span>
<span class="n">BlueColourMatch</span> <span class="o">=</span> <span class="mf">0.425</span> <span class="c1">#: Colour matching Blue in microns</span>
<span class="n">GreenColourMatch</span> <span class="o">=</span> <span class="mf">0.53</span> <span class="c1">#: Colour matching Green in microns</span>
<span class="n">RedColourMatch</span> <span class="o">=</span> <span class="mf">0.65</span>   <span class="c1">#: Colour matching Blue in microns</span>
<span class="n">ScotopicPeak</span> <span class="o">=</span> <span class="mf">0.502819</span>   <span class="c1">#: Scotopic peak in microns</span>
<span class="n">ScotopicWidth</span> <span class="o">=</span> <span class="mf">0.0555317</span> <span class="c1">#: Scotopic width in microns </span>
<span class="n">PhotopicPeak</span> <span class="o">=</span> <span class="mf">0.5559087</span>  <span class="c1">#: Photopic peak in microns</span>
<span class="n">PhotopicWidth</span> <span class="o">=</span> <span class="mf">0.0599179</span> <span class="c1">#: Photopic with in microns</span>
<span class="n">Mercury_i</span> <span class="o">=</span> <span class="mf">0.36501</span>    <span class="c1">#: Mercury i line in microns</span>
<span class="n">Mercury_h</span> <span class="o">=</span> <span class="mf">0.4046561</span>  <span class="c1">#: Mercury h line in microns</span>
<span class="n">Mercury_g</span> <span class="o">=</span> <span class="mf">0.4358343</span>  <span class="c1">#: Mercury g line in microns</span>
<span class="n">Cadmium_F</span> <span class="o">=</span> <span class="mf">0.4799914</span>  <span class="c1">#: Cadium F line in microns.</span>
<span class="n">Hydrogen_F</span> <span class="o">=</span> <span class="mf">0.4861327</span> <span class="c1">#: Hydrodgen F line in microns</span>
<span class="n">Mercury_e</span> <span class="o">=</span> <span class="mf">0.546073</span>   <span class="c1">#: Mercury e line in microns</span>
<span class="n">Helium_d</span> <span class="o">=</span> <span class="mf">0.5875618</span>   <span class="c1">#: Helium d line</span>
<span class="n">Sodium_D2</span> <span class="o">=</span> <span class="mf">0.5889953</span>  <span class="c1">#: Sodium D2 line</span>
<span class="n">Sodium_D</span> <span class="o">=</span> <span class="mf">0.5892938</span>   <span class="c1">#: Sodium D (average) line</span>
<span class="n">Sodium_D1</span> <span class="o">=</span> <span class="mf">0.5895923</span>  <span class="c1">#: Sodium D1 line</span>
<span class="n">Cadmium_C</span> <span class="o">=</span> <span class="mf">0.6438469</span>  <span class="c1">#: Cadmium C line</span>
<span class="n">Hydrogen_C</span> <span class="o">=</span> <span class="mf">0.6562725</span> <span class="c1">#: Hydeogen C line</span>
<span class="n">Helium_r</span> <span class="o">=</span> <span class="mf">0.7065188</span>   <span class="c1">#: Helium r line</span>
<span class="n">Potassium_A</span> <span class="o">=</span> <span class="mf">0.7682</span>   <span class="c1">#: Potatium A line</span>
<span class="n">Caesium_s</span> <span class="o">=</span> <span class="mf">0.85211</span>    <span class="c1">#: Caesium s line</span>
<span class="n">Mercury_t</span> <span class="o">=</span> <span class="mf">1.01398</span>    <span class="c1">#: Mercury t line</span>
<span class="n">ArgonBlue</span> <span class="o">=</span> <span class="mf">0.4880</span>   <span class="c1">#: Argon Ion Blue</span>
<span class="n">ArgonGreen</span> <span class="o">=</span> <span class="mf">0.5145</span>  <span class="c1">#: Argon Ion Green</span>
<span class="n">KryptonRed</span> <span class="o">=</span> <span class="mf">0.6471</span>  <span class="c1">#: Krypton Ion Red</span>
<span class="n">HeNeGreen</span> <span class="o">=</span> <span class="mf">0.5435</span>   <span class="c1">#: Helium Neon Green</span>
<span class="n">HeNeYellow</span> <span class="o">=</span> <span class="mf">0.594</span>   <span class="c1">#: Helium Neon Yellow</span>
<span class="n">HeNeRed</span> <span class="o">=</span> <span class="mf">0.6328</span>     <span class="c1">#: Helium Neon Red</span>
<span class="n">HeCdBlue</span> <span class="o">=</span> <span class="mf">0.441563</span>  <span class="c1">#: Helium Cadmium Blue</span>
<span class="n">HeCdUV</span> <span class="o">=</span> <span class="mf">0.325</span>       <span class="c1">#: Helium Cadmium UV</span>
<span class="n">NdYagIR</span> <span class="o">=</span> <span class="mf">1.064</span>      <span class="c1">#: Neodinium primary (IR)</span>
<span class="n">NdYagGreen</span> <span class="o">=</span> <span class="mf">0.532</span>   <span class="c1">#: Neodinium doubled (Green)</span>
<span class="n">Ruby</span> <span class="o">=</span> <span class="mf">0.6943</span>        <span class="c1">#: Ruby red.</span>
<span class="n">DiodeRed</span> <span class="o">=</span> <span class="mf">0.68</span>      <span class="c1">#: Laser diode red</span>
<span class="n">DiodeNearIR</span> <span class="o">=</span> <span class="mf">0.785</span>  <span class="c1">#: Laser diode near IR</span>
<span class="n">DiodeMidIR</span> <span class="o">=</span> <span class="mf">0.86</span>    <span class="c1">#: Laser diode mid IR</span>
<span class="n">DiodeLongIR</span> <span class="o">=</span> <span class="mf">1.5</span>    <span class="c1">#: Laser diode long IR</span>


<div class="viewcode-block" id="getInitialDefaultWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.getInitialDefaultWavelength">[docs]</a><span class="k">def</span> <span class="nf">getInitialDefaultWavelength</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to extarct the default wavelength from environmentalvariable DEFAULTWAVELENGTH.</span>
<span class="sd">    It can be set to numerical value or any the wavelengths specified as Globals above.</span>
<span class="sd">    If environemntal variale not set, then defaults of Green = 0.55 is used</span>

<span class="sd">    This is called automatically once on startup and set the global variable Default.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DEFAULTWAVELENGTH&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Green</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">))</span></div>
<span class="c1">#</span>
<span class="c1">#          Package default wavelength held in global.</span>

<span class="n">Default</span> <span class="o">=</span> <span class="n">getInitialDefaultWavelength</span><span class="p">()</span>       <span class="c1">#     Package default wevelength</span>



<div class="viewcode-block" id="setDefaultWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.setDefaultWavelength">[docs]</a><span class="k">def</span> <span class="nf">setDefaultWavelength</span><span class="p">(</span><span class="n">w</span> <span class="o">=</span> <span class="n">Green</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to set the default wavelength from within the package my resetting the global variable Default.</span>

<span class="sd">    :param w: The new default wavelength in microns, (default = Green, 0.55, the original package default)</span>
<span class="sd">    :type w: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">Default</span>
    <span class="n">Default</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span></div>


<div class="viewcode-block" id="getDefaultWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.getDefaultWavelength">[docs]</a><span class="k">def</span> <span class="nf">getDefaultWavelength</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to get the default wavelength.</span>

<span class="sd">    :return: the current default wavelength as a float.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Default</span></div>


<span class="n">CurrentWavelength</span> <span class="o">=</span> <span class="n">getDefaultWavelength</span><span class="p">()</span>

<div class="viewcode-block" id="getCurrentWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.getCurrentWavelength">[docs]</a><span class="k">def</span> <span class="nf">getCurrentWavelength</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the current wavelength , typically used by GUI intreface</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">CurrentWavelength</span></div>

    
<div class="viewcode-block" id="setCurrentWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.setCurrentWavelength">[docs]</a><span class="k">def</span> <span class="nf">setCurrentWavelength</span><span class="p">(</span><span class="n">wave</span> <span class="o">=</span> <span class="n">Green</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the Current Wavelnegth, typically used by GUI interface</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">CurrentWavelength</span>
    <span class="n">CurrentWavelength</span> <span class="o">=</span> <span class="n">wave</span></div>
    

<div class="viewcode-block" id="getInitialDesignWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.getInitialDesignWavelength">[docs]</a><span class="k">def</span> <span class="nf">getInitialDesignWavelength</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to extarct the design wavelength from environmentalvariable DESIGNWAVELENGTH.</span>
<span class="sd">    It can be set to numerical value or any the wavelengths specified as Globals above.</span>
<span class="sd">    If environemntal variale not set, then defaults of Green = 0.55 is used</span>

<span class="sd">    This is called automatically once on startup and set the global variable Default.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DESIGNWAVELENGTH&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">val</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Green</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">))</span></div>
<span class="c1">#</span>
<span class="c1">#          Package default wavelength held in global.</span>

<span class="n">Design</span> <span class="o">=</span> <span class="n">getInitialDesignWavelength</span><span class="p">()</span>       <span class="c1">#     Package design wevelength</span>

<div class="viewcode-block" id="setDesignWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.setDesignWavelength">[docs]</a><span class="k">def</span> <span class="nf">setDesignWavelength</span><span class="p">(</span><span class="n">w</span> <span class="o">=</span> <span class="n">Green</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to set the design wavelength from within the package my resetting the global variable Default.</span>

<span class="sd">    :param w: The new design wavelength in microns, (default is back to package default of Green, 0.55)</span>
<span class="sd">    :type w: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">Design</span>
    <span class="n">Design</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="getDesignWavelength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.getDesignWavelength">[docs]</a><span class="k">def</span> <span class="nf">getDesignWavelength</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to get the design wavelength.</span>

<span class="sd">    :return: the design wavelength as a float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Design</span></div>


<span class="n">FixedAirIndex</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">FixedAirIndexValue</span> <span class="o">=</span> <span class="mf">1.0</span>

<div class="viewcode-block" id="setFixedAirIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.setFixedAirIndex">[docs]</a><span class="k">def</span> <span class="nf">setFixedAirIndex</span><span class="p">(</span><span class="nb">type</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the Refrective index for the package, the default is variale.</span>

<span class="sd">    :param type: Sets fixed index for package, (defaults to True)</span>
<span class="sd">    :type type: bool</span>
<span class="sd">    :param value: the value of the fixed index (default to 1.0)</span>
<span class="sd">    :type value: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">FixedAirIndex</span>
    <span class="k">global</span> <span class="n">FixedAirIndexValue</span>
    <span class="n">FixedAirIndex</span> <span class="o">=</span> <span class="nb">type</span>
    <span class="n">FixedAirIndexValue</span> <span class="o">=</span> <span class="n">value</span></div>
    

<span class="c1">#</span>
<div class="viewcode-block" id="WaveLength"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.WaveLength">[docs]</a><span class="k">class</span> <span class="nc">WaveLength</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Define Abstract class to deal with functions of wavelength.  There is a default</span>
<span class="sd">    constructor to set defaults, typically called by extending classes only there are no parameters, </span>
<span class="sd">    it just initialises variables. </span>

<span class="sd">    There are three local variable to control plotting and information</span>

<span class="sd">    - self.dynamic = False (forces new calcculation for every call)</span>
<span class="sd">    - self.minWavelength = BlueLimit</span>
<span class="sd">    - self.maxWavelenth = Redlimit</span>
<span class="sd">    - self.plotPoints = 100</span>
<span class="sd">    - self.title = None</span>


<span class="sd">    &quot;&quot;&quot;</span>          
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    
        <span class="bp">self</span><span class="o">.</span><span class="n">valid</span> <span class="o">=</span> <span class="kc">True</span>                         <span class="c1"># Defaults to True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentWavelength</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Nan&quot;</span><span class="p">)</span>     <span class="c1"># Default to illegal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;Nan&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamic</span> <span class="o">=</span> <span class="kc">False</span>                      <span class="c1"># Flag to force dynamics calls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minWavelength</span> <span class="o">=</span> <span class="n">BlueLimit</span>            <span class="c1"># Plot paramters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxWavelength</span> <span class="o">=</span> <span class="n">RedLimit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotPoints</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>                         <span class="c1"># User title</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The str functoon, will be overwritten</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;Abstract&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The repr function, may get overwritten</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0:s}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Validity flag  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid</span>

    <span class="c1">#         </span>
<div class="viewcode-block" id="WaveLength.getValue"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.WaveLength.getValue">[docs]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span> <span class="o">=</span> <span class="n">Default</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get the current value as the specified wavelength</span>
<span class="sd">        param wave the wavelength, this is assumes be a float OR any object</span>
<span class="sd">        that has .wavelength as a float variable. </span>

<span class="sd">        :param wave: wavelength (Defaults to package default, usually 0.55 microns)</span>
<span class="sd">        :type wave: float or object.wavelength (in microns)</span>
<span class="sd">        :return: the value as a float.</span>

<span class="sd">        This will cache the value from the last call so if called again with the same wavelength it will not recalculate. </span>
<span class="sd">        This is controlled by self.dynamic, which is set to True will calcualte a new value for every call.</span>

<span class="sd">        This is the normal call for all classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span><span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">wave</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">wavelength</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Wavelength.getValue(): call with unknown type </span><span class="si">{0:s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wave</span><span class="p">)))</span>
        <span class="c1">#</span>
        <span class="c1">#                           If value at this wavelength is know, use it</span>
        <span class="c1">#       </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamic</span> <span class="ow">or</span> <span class="n">w</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentWavelength</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentWavelength</span> <span class="o">=</span> <span class="n">w</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentWavelength</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentValue</span></div>


<div class="viewcode-block" id="WaveLength.getDerivative"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.WaveLength.getDerivative">[docs]</a>    <span class="k">def</span> <span class="nf">getDerivative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span> <span class="o">=</span> <span class="n">Default</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the derivative dn/dl numerically using 4 point approximation with delta = wave / 2000 (which will have</span>
<span class="sd">        negligible errors for a smooth function)</span>

<span class="sd">        :param wave: wavelength (Defaults to package default, usually 0.55 microns)</span>
<span class="sd">        :type wave: float or object.wavelength (in microns)</span>
<span class="sd">        :return: the derivative as a float.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span><span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">wave</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">wavelength</span><span class="p">,</span><span class="nb">float</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">wavelength</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Wavelength.getDerivative(): call with unknown type </span><span class="si">{0:s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wave</span><span class="p">)))</span>
        
        <span class="n">delta</span> <span class="o">=</span> <span class="n">w</span>  <span class="o">/</span> <span class="mf">2000.0</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">delta</span><span class="p">)</span> <span class="o">-</span> <span class="mf">8.0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span> <span class="o">+</span> <span class="mf">8.0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span> <span class="o">-</span> \
           <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">delta</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">12.0</span><span class="o">*</span><span class="n">delta</span><span class="p">)</span></div>
           

    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Abstract iunternal method to get the value at a new wavelength (needs to be defined)</span>

<span class="sd">        :param wave: the wavelength </span>
<span class="sd">        :type wave: float</span>
<span class="sd">        :return: the value at this wavelength.</span>

<span class="sd">        This is not normally called direclty but is called via .getValue()</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;wavelength.Wavelength.getNewValue not implemnted, Class is abstract.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="WaveLength.getArrayValues"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.WaveLength.getArrayValues">[docs]</a>    <span class="k">def</span> <span class="nf">getArrayValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave_array</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get an array of values for a NumPy array</span>

<span class="sd">        :param wave_array: a Numpy array of wavelengths in microms</span>
<span class="sd">        :type wave_array: np.array</span>
<span class="sd">        :return: values as a Numpy.array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">wave_array</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">wave</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wave_array</span><span class="p">):</span>
            <span class="n">out_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_array</span></div>

<div class="viewcode-block" id="WaveLength.getArrayDerivatives"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.WaveLength.getArrayDerivatives">[docs]</a>    <span class="k">def</span> <span class="nf">getArrayDerivatives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave_array</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get array of derivatives values for a NumPy array</span>

<span class="sd">        :param wave_array: a Numpy array of wavelengths in microms</span>
<span class="sd">        :type wave_array: Numpy.array</span>
<span class="sd">        :return: values as a Numpy.array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">wave_array</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">wave</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wave_array</span><span class="p">):</span>
            <span class="n">out_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDerivative</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">out_array</span></div>

    <span class="c1">#         </span>
    <span class="c1">#</span>
<div class="viewcode-block" id="WaveLength.draw"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.WaveLength.draw">[docs]</a>    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">colour</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">derivative</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot to the current Matplotlib axis.</span>

<span class="sd">        - self.minWavelenth (Default 0.35)</span>
<span class="sd">        - self.maxWavelength (Default 0.65)</span>
<span class="sd">        </span>
<span class="sd">        :param colour: colour passed to matplotlib (defaults to &#39;r&#39;)</span>
<span class="sd">        :type colour: Color or str</span>
<span class="sd">        :param derivative: if True will plot the derivative, (default is False)</span>
<span class="sd">        :type derivatice: Bool</span>
<span class="sd">        :return: None</span>
<span class="sd">        </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minWavelength</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">maxWavelength</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plotPoints</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">derivative</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getArrayDerivatives</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getArrayValues</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">colour</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span></div></div>


<span class="c1">#</span>
<span class="c1">#</span>
<div class="viewcode-block" id="RefractiveIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.RefractiveIndex">[docs]</a><span class="k">class</span> <span class="nc">RefractiveIndex</span><span class="p">(</span><span class="n">WaveLength</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class RefrativeIndex which extends WaveLength to handle different types of </span>
<span class="sd">    Refrative Index. Class is Abstract, need to be extended to be useful.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Default constuctor, same as WaveLength, does nothing but sets defaults.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">WaveLength</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1">#         </span>
<div class="viewcode-block" id="RefractiveIndex.getNd"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.RefractiveIndex.getNd">[docs]</a>    <span class="k">def</span> <span class="nf">getNd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get refrative index at the Helium_d line.</span>

<span class="sd">        :return: float value of referative index Nd</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">Helium_d</span><span class="p">)</span></div>
    <span class="c1">#</span>
    <span class="c1">#          </span>
<div class="viewcode-block" id="RefractiveIndex.getNe"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.RefractiveIndex.getNe">[docs]</a>    <span class="k">def</span> <span class="nf">getNe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get the refrative index at the Mercury_e line.</span>

<span class="sd">        :return:float calue of refratcive index Ne</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">Mercury_e</span><span class="p">)</span></div>
    <span class="c1">#          </span>
    <span class="c1">#</span>
<div class="viewcode-block" id="RefractiveIndex.getVd"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.RefractiveIndex.getVd">[docs]</a>    <span class="k">def</span> <span class="nf">getVd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get the Abbe or Vd number, calculated at the Helium_d, Hydroden_F and Hydroden_C lines.</span>
<span class="sd">        Will return zero if non-dispersive.</span>

<span class="sd">        :return: float the Vd number.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNd</span><span class="p">()</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">Hydrogen_F</span><span class="p">)</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">Hydrogen_C</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">!=</span> <span class="n">nc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">nd</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nf</span> <span class="o">-</span> <span class="n">nc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>               <span class="c1"># Non dispersive</span></div>
    <span class="c1">#    </span>
    <span class="c1">#</span>
<div class="viewcode-block" id="RefractiveIndex.getVe"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.RefractiveIndex.getVe">[docs]</a>    <span class="k">def</span> <span class="nf">getVe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get the Mercury Abbe or Ve number, cacaulted at the Mercury_e, Cadmium_F and Cadmium_C lines.</span>
<span class="sd">        Will return zero if non-dispersive. </span>

<span class="sd">        :return: float  the Ve numbers.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ne</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNe</span><span class="p">()</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">Cadmium_F</span><span class="p">)</span>
        <span class="n">nc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">Cadmium_C</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nf</span> <span class="o">!=</span> <span class="n">nc</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">ne</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">nf</span> <span class="o">-</span> <span class="n">nc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span></div>
    <span class="c1">#</span>
    <span class="c1">#</span>
<div class="viewcode-block" id="RefractiveIndex.getType"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.RefractiveIndex.getType">[docs]</a>    <span class="k">def</span> <span class="nf">getType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get the type number on nnnVVV for format using calculated from the Nd and Vd numbers.</span>
<span class="sd">        </span>
<span class="sd">        :return: int XXXYYY when nd = 1.XXX and Vd = Y.YY</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getNd</span><span class="p">()</span>
        <span class="n">vd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVd</span><span class="p">()</span>
        <span class="n">nd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">nd</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span><span class="p">))</span>
        <span class="n">vd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">vd</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">nd</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">vd</span></div></div>
        
<span class="c1">#</span>
<span class="c1">#</span>
<div class="viewcode-block" id="InfoIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.InfoIndex">[docs]</a><span class="k">class</span> <span class="nc">InfoIndex</span><span class="p">(</span><span class="n">RefractiveIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implment a RefractiveIndex in the format suppled by RefractiveIndex.info website,</span>
<span class="sd">    all have common calls.</span>
<span class="sd">    </span>
<span class="sd">    :param formula: formula type, (1,2,3,5,6 and 7 implementated)</span>
<span class="sd">    :type formula: int</span>
<span class="sd">    :param wrange: list of two float giving validity range</span>
<span class="sd">    :type wrange: list</span>
<span class="sd">    :param coef: list of floats holding the coefficents.</span>
<span class="sd">    :type coef: list</span>
<span class="sd">    :param name:  name or key (defaults to InfoIndex)</span>
<span class="sd">    :type name: str</span>

<span class="sd">    This class is not typically called by the used, the normal intreface is MaterialIndex</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">formula</span><span class="p">,</span><span class="n">wrange</span><span class="p">,</span><span class="n">coef</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;InfoIndex&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constuctor</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Format is same as in RefrativeIndex.info database.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">RefractiveIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">wrange</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement str() to give full inpormation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">{0:d}</span><span class="s2">, </span><span class="si">{1:s}</span><span class="s2">, </span><span class="si">{2:s}</span><span class="s2">, </span><span class="si">{3:s}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1">#</span>
<div class="viewcode-block" id="InfoIndex.copy"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.InfoIndex.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Define copy method to give deep copy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">InfoIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">),</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span></div>
    <span class="c1">#</span>
    <span class="c1">#          </span>
    
    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get the new value as specified wavelength</span>
<span class="sd">        param wave float the wavelength</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wave</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">wave</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;InfoIndex: range warning: </span><span class="si">{0:7.5f}</span><span class="s2"> called but range </span><span class="si">{1:7.5f}</span><span class="s2"> to </span><span class="si">{2:7.5f}</span><span class="s2">&quot;</span><span class="o">.</span>\
                  <span class="nb">format</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>        

        <span class="c1">#        Implment the various formula</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>               <span class="c1"># Sellmeir with Sqr of lower compoent</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>             <span class="c1"># Put in first C (nornmally zero)</span>
            <span class="n">lSqrInv</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">wave</span><span class="o">*</span><span class="n">wave</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">lSqrInv</span><span class="o">*</span><span class="n">c</span><span class="o">*</span><span class="n">c</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>             <span class="c1"># Sellmeir with Linear lower component.</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>             <span class="c1"># Put in first C (nornmally zero)</span>
            <span class="n">lSqrInv</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">wave</span><span class="o">*</span><span class="n">wave</span><span class="p">)</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">lSqrInv</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
            
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>            <span class="c1"># Polynomial</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                  <span class="c1"># Put in first C </span>
        
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
               
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>


        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>             <span class="c1"># Full Cauchy</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                   <span class="c1"># Put in first C </span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="n">wave</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
               
            <span class="k">return</span> <span class="n">n</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>            <span class="c1"># Gas index</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>            <span class="c1"># First parmeter, usually 0</span>
            <span class="n">overlSqr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">wave</span><span class="o">*</span><span class="n">wave</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">),</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">overlSqr</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">n</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>            <span class="c1"># Herzberger</span>
            <span class="n">lSqr</span> <span class="o">=</span> <span class="n">wave</span><span class="o">*</span><span class="n">wave</span>
            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">lSqr</span> <span class="o">-</span> <span class="mf">0.028</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">lSqr</span> <span class="o">-</span> <span class="mf">0.028</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)):</span>
                <span class="n">lSqr</span> <span class="o">*=</span> <span class="p">(</span><span class="n">wave</span><span class="o">*</span><span class="n">wave</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">lSqr</span>
            <span class="k">return</span> <span class="n">n</span>
                                                            
            
    
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;wavelength.InfoIndex: formula </span><span class="si">{0:d}</span><span class="s2">. Material </span><span class="si">{1:s}</span><span class="s2">&quot;</span><span class="o">.</span>\
                                      <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>        </div>
    
<div class="viewcode-block" id="MaterialIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.MaterialIndex">[docs]</a><span class="k">class</span> <span class="nc">MaterialIndex</span><span class="p">(</span><span class="n">InfoIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    General class for Material Index with indices looked up in ethe internal package dattbase (is normal user interface)</span>

<span class="sd">    :param key: the index key, eg &quot;BK7&quot; </span>
<span class="sd">    :type key: str</span>
<span class="sd">    :param database: the index database, (Default = None which use package standard)</span>
<span class="sd">    :type database: str</span>

<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">database</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Created a material refratcive index by key</span>
<span class="sd">        param key the Index Key (name), if None, you will be prompted</span>
<span class="sd">        parameter database Material database, of None, used package default</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span>  <span class="n">key</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;air&quot;</span><span class="p">:</span>     <span class="c1"># Trap air as special case</span>
            <span class="n">AirIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">material</span> <span class="o">=</span> <span class="n">MaterialData</span><span class="p">(</span><span class="n">database</span><span class="p">)</span><span class="o">.</span><span class="n">getMaterial</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>     <span class="c1"># Get material</span>
            <span class="n">InfoIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">material</span><span class="o">.</span><span class="n">formula</span><span class="p">,</span><span class="n">material</span><span class="o">.</span><span class="n">wrange</span><span class="p">,</span><span class="n">material</span><span class="o">.</span><span class="n">coef</span><span class="p">,</span><span class="n">material</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>


    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;           str to give name and range only</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot; n: </span><span class="si">{0:s}</span><span class="s2"> r : (</span><span class="si">{1:7.5f}</span><span class="s2"> , </span><span class="si">{2:7.5f}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>
            
        
<div class="viewcode-block" id="FixedIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.FixedIndex">[docs]</a><span class="k">class</span> <span class="nc">FixedIndex</span><span class="p">(</span><span class="n">RefractiveIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implement a simple fixed index.</span>

<span class="sd">    :param n: the refrative index</span>
<span class="sd">    :type n: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement a simple fixed index</span>
<span class="sd">        param n the fixed index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">RefractiveIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Fixed Index&quot;</span>
        
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implment str()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot; n: (</span><span class="si">{0:7.5f}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">w</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the NewValue, does not depend of wavelength.</span>
<span class="sd">        param w the wavelngth, which is ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span></div>
    
        
<div class="viewcode-block" id="AirIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.AirIndex">[docs]</a><span class="k">class</span> <span class="nc">AirIndex</span><span class="p">(</span><span class="n">InfoIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for AirIndex, this is either fixed or a special cals of InfoIndex with fixed paramers. Controlled by Global variiable</span>
<span class="sd">    self.FixedAirIndex which defaults to False.</span>

<span class="sd">    :param none: No parameters</span>


<span class="sd">    &quot;&quot;&quot;</span>
   
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        No parameter conctructor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">InfoIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">6</span><span class="p">,[</span><span class="mf">0.23</span><span class="p">,</span><span class="mf">1.69</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.05792105</span><span class="p">,</span> <span class="mf">238.0185</span><span class="p">,</span> <span class="mf">0.00167917</span><span class="p">,</span> <span class="mf">57.362</span><span class="p">],</span><span class="s2">&quot;air&quot;</span><span class="p">)</span>

    <span class="c1">#     Set __str__ </span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">FixedAirIndex</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot; fixed: </span><span class="si">{0:7.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">FixedAirIndexValue</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot; variable &quot;</span>

<div class="viewcode-block" id="AirIndex.copy"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.AirIndex.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a copy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">AirIndex</span><span class="p">()</span></div>
    
    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a new value as specified wavelenght taking into accouth the Fixed index flag</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">FixedAirIndex</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">FixedAirIndexValue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">InfoIndex</span><span class="o">.</span><span class="n">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">)</span>   <span class="c1"># Do the full calculation</span></div>

<div class="viewcode-block" id="CauchyIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.CauchyIndex">[docs]</a><span class="k">class</span> <span class="nc">CauchyIndex</span><span class="p">(</span><span class="n">InfoIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implement the simple a + b/lambda^2 + c / lambda^4 Cauchy index, with either a,b,c or  Nd,Vd or</span>
<span class="sd">    XXXYYY int whhere Nd = 1.XXX and Vd = Y.YY. The actual calcualtion is done by infoIndex with formula no 5.</span>

<span class="sd">    :param a_or_nd:  a vaule in the Cauchy formula if 3 parmeters, the Nd value if two, or type integer if one.</span>
<span class="sd">    :type a_or_nd: float OR int</span>
<span class="sd">    :param b_or_vd: b value in Cauchy formula if 3 parameters, else Vd id two given</span>
<span class="sd">    :type b_or_vd: float</span>
<span class="sd">    :param c: c value in Caucby formula (may be None)</span>
<span class="sd">    :type c: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_or_nd</span><span class="p">,</span> <span class="n">b_or_vd</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">              Implement a simple Cauchy index with variable parameter types</span>
<span class="sd">             </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>                      <span class="c1"># all three parameters given</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a_or_nd</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b_or_vd</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
            <span class="n">InfoIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span><span class="s2">&quot;Cauchy&quot;</span><span class="p">)</span>    <span class="c1"># Use InforIndex of type 5 with 3 paramters</span>

        <span class="k">elif</span> <span class="n">b_or_vd</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>             <span class="c1"># Two paramters</span>
            <span class="n">nd</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a_or_nd</span><span class="p">)</span>
            <span class="n">vd</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b_or_vd</span><span class="p">)</span>
            <span class="n">lf</span> <span class="o">=</span> <span class="n">Hydrogen_F</span>
            <span class="n">lc</span> <span class="o">=</span> <span class="n">Hydrogen_C</span>
            <span class="n">ld</span> <span class="o">=</span> <span class="n">Helium_d</span>

            <span class="n">b</span> <span class="o">=</span> <span class="n">lf</span><span class="o">*</span><span class="n">lf</span><span class="o">*</span><span class="n">lc</span><span class="o">*</span><span class="n">lc</span><span class="o">*</span><span class="p">(</span><span class="n">nd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">vd</span><span class="o">*</span><span class="p">(</span><span class="n">lc</span><span class="o">*</span><span class="n">lc</span> <span class="o">-</span> <span class="n">lf</span><span class="o">*</span><span class="n">lf</span><span class="p">))</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">nd</span> <span class="o">-</span> <span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">ld</span><span class="o">*</span><span class="n">ld</span><span class="p">)</span>
            <span class="n">InfoIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="s2">&quot;Cauchy&quot;</span><span class="p">)</span>       <span class="c1"># Use InfoIndex of type 5 with 2 parameters</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a_or_nd</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>                                     <span class="c1"># int index/Vd type, unpack and re-call with two params</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="n">a_or_nd</span><span class="o">//</span><span class="mi">1000</span>
            <span class="n">ap</span> <span class="o">=</span> <span class="n">a_or_nd</span> <span class="o">-</span> <span class="mi">1000</span><span class="o">*</span><span class="n">ip</span>
            <span class="n">nd</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">ip</span><span class="o">/</span><span class="mf">1000.0</span>
            <span class="n">vd</span> <span class="o">=</span> <span class="n">ap</span><span class="o">/</span><span class="mf">10.0</span>
            <span class="n">CauchyIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nd</span><span class="p">,</span><span class="n">vd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;wavelnegth.SimpleCauchyIndex(): called with unknown types&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements str to give nd and Vd values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot; nd: </span><span class="si">{0:7.5f}</span><span class="s2"> Vd: </span><span class="si">{1:7.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getNd</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">getVd</span><span class="p">())</span></div>
            
<div class="viewcode-block" id="Sellmeier"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.Sellmeier">[docs]</a><span class="k">class</span> <span class="nc">Sellmeier</span><span class="p">(</span><span class="n">InfoIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implemnts a simple two parameter Sellmier index for experimental physics.</span>
<span class="sd">    Use InfoIndex class with formula 1 with parmeters C[0] = 0.0, C[1] = alpha, C[2] = lambda_0</span>

<span class="sd">    :param alpha: the alpha parameter</span>
<span class="sd">    :param lambda_0: The resonance lambda_0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">lambda_0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">InfoIndex</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.7</span><span class="p">],[</span><span class="mf">0.0</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span><span class="nb">float</span><span class="p">(</span><span class="n">lambda_0</span><span class="p">)],</span><span class="s2">&quot;Sellmeier&quot;</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;alpha : </span><span class="si">{0:7.5f}</span><span class="s2"> lambda_0 : </span><span class="si">{1:7.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getAlpha</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">getLambdaZero</span><span class="p">())</span>
        
<div class="viewcode-block" id="Sellmeier.getAlpha"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.Sellmeier.getAlpha">[docs]</a>    <span class="k">def</span> <span class="nf">getAlpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the alpha coef</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="Sellmeier.getLambdaZero"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.Sellmeier.getLambdaZero">[docs]</a>    <span class="k">def</span> <span class="nf">getLambdaZero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Lambda_0 coef</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></div>

<div class="viewcode-block" id="Sellmeier.fitIndex"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.Sellmeier.fitIndex">[docs]</a>    <span class="k">def</span> <span class="nf">fitIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">,</span><span class="n">ref</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit a Sellmier Index with numpy arrays of wavelength and refratice index. It will take the </span>
<span class="sd">        current values of alpha and lambda_0 as the starting values.</span>

<span class="sd">        The fit paramters will also be held as intrenal variables popt and pcov</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#        Define the fit function with two parameters</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">wave</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">Sellmeier</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">getArrayValues</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
        <span class="c1">#        Do the fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popt</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="n">wave</span><span class="p">,</span><span class="n">ref</span><span class="p">,</span><span class="n">p0</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getAlpha</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">getLambdaZero</span><span class="p">()])</span>

        <span class="c1"># Return the new fitted index</span>
        <span class="k">return</span> <span class="n">Sellmeier</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">popt</span><span class="p">)</span></div></div>

    
<span class="k">class</span> <span class="nc">GradedIndex</span><span class="p">(</span><span class="n">RefractiveIndex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to implement a graded index with a underlying base index and a radially symmeetric variation</span>
<span class="sd">    that depend on radial distance from an origin.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pt</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">coef</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        param pt, two dimensional point giving the location of the origin, </span>
<span class="sd">        param index, the base refrative index</span>
<span class="sd">        param coef the for radial polynomial if form 1,r^2,r^4 .... as a list of floats.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point</span> <span class="o">=</span> <span class="n">Vector2d</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make fully copy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">GradedIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">coef</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;wavelength.GradedIndex: pt : </span><span class="si">{0:s}</span><span class="s2"> coef : </span><span class="si">{1:s}</span><span class="se">\n</span><span class="s2"> base : </span><span class="si">{2:s}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">),</span>\
                                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coef</span><span class="p">),</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ray_or_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get the value, overloads method in super classes</span>
<span class="sd">        param ray_or_wave either ray or wavelength, if wavelength gets based value</span>
<span class="sd">        if ray get position dependand index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">ray_or_wave</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ray_or_wave</span><span class="p">,</span><span class="s2">&quot;position&quot;</span><span class="p">):</span>    <span class="c1"># Its a ray</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">ray_or_wave</span><span class="o">.</span><span class="n">position</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span>
            <span class="n">rsqr</span> <span class="o">=</span> <span class="n">dx</span><span class="o">*</span><span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span>
            <span class="n">r</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">r</span> <span class="o">*=</span> <span class="n">rsqr</span>
                <span class="n">weight</span> <span class="o">+=</span> <span class="n">c</span><span class="o">*</span><span class="n">r</span>  
                <span class="k">return</span> <span class="n">base</span><span class="o">*</span><span class="n">weight</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">base</span>                       <span class="c1"># its a scalar</span>

        



    <span class="k">def</span> <span class="nf">getGradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ray</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to calcualte the Gradient as specifed ray position</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">position</span>
            
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">x</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">y</span>
        <span class="n">rsqr</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>

        <span class="n">dx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        for i in range(2,len(self.coef)):</span>
<span class="sd">            r = math.pow(rsqr,i-1)</span>
<span class="sd">            dx += 2*x*n*i*coef[i]*r</span>
<span class="sd">            dy += 2*y*n*i*coef[i]*r</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">return</span> <span class="n">Vector3d</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>

<div class="viewcode-block" id="Spectrum"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.Spectrum">[docs]</a><span class="k">class</span> <span class="nc">Spectrum</span><span class="p">(</span><span class="n">WaveLength</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base Sepectrum class, implments a constant spectrum.</span>

<span class="sd">    :param bright: the intensity brightness (Default = 1.0)</span>
<span class="sd">    :type bright: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#  </span>
    <span class="c1">#</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bright</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set only brighnness</span>
<span class="sd">        param bright, float, the brighness,(defaults to 1.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">WaveLength</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">bright</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; b: </span><span class="si">{0:8.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the new value, always returns brighntess</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span></div>

        

<div class="viewcode-block" id="GaussianSpectrum"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.GaussianSpectrum">[docs]</a><span class="k">class</span> <span class="nc">GaussianSpectrum</span><span class="p">(</span><span class="n">Spectrum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for a Guassian Spectrum with specifed peak, width and brightness.</span>

<span class="sd">    :param peak: the peak of the spectrum in microns.</span>
<span class="sd">    :type peak: float</span>
<span class="sd">    :param width: the width to =/1 e{-1} point in microms</span>
<span class="sd">    :type width: float</span>
<span class="sd">    :param bright: the peak brightness, (Defaults to 1.0)</span>
<span class="sd">    :type bright: float</span>

<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">peak</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">bright</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Spectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bright</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peak</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">peak</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Gaussian Spectrum&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The str function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;p: </span><span class="si">{0:7.5f}</span><span class="s2"> w: </span><span class="si">{1:7.5f}</span><span class="s2"> b: </span><span class="si">{2:7.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peak</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">)</span>

    
    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Get the new value at specified wavelength</span>
<span class="sd">        param wave the wavelength in microns</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">peak</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">))</span></div>


<div class="viewcode-block" id="PlanckSpectrum"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.PlanckSpectrum">[docs]</a><span class="k">class</span> <span class="nc">PlanckSpectrum</span><span class="p">(</span><span class="n">Spectrum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to give the hot body Planck spectrum  at specified temperature and emissitivity</span>

<span class="sd">    :param t: the blackbody temperture in Kelvin (Default = 5,000)</span>
<span class="sd">    :type t: float</span>
<span class="sd">    :param emissitivity: the emmisttivity factor (defaults to 1.0)</span>
<span class="sd">    :type emissitivity: float</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="mf">5000.0</span><span class="p">,</span> <span class="n">emissitivity</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Spectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">emissitivity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mf">5.026e6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mf">1.44e4</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The str() function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">{0:8.6e}</span><span class="s2">, </span><span class="si">{1:8.6e}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>


<div class="viewcode-block" id="PlanckSpectrum.setTemperature"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.PlanckSpectrum.setTemperature">[docs]</a>    <span class="k">def</span> <span class="nf">setTemperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  </span>
<span class="sd">        Set the tempertaure</span>

<span class="sd">        :param t: the tenperture in degrees Kelvin</span>
<span class="sd">        :type t: float</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span></div>

    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the new value </span>
<span class="sd">        param wave the wavelength</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">wave</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">wave</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">val</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span></div>



<span class="c1">#            PhotopicSpectrum </span>
<span class="c1">#</span>
<div class="viewcode-block" id="PhotopicSpectrum"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.PhotopicSpectrum">[docs]</a><span class="k">class</span> <span class="nc">PhotopicSpectrum</span><span class="p">(</span><span class="n">GaussianSpectrum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Phototic (high light level) normal spectral response of the eye.</span>

<span class="sd">    :param bright: peak brightness, (Default = 1.0)</span>
<span class="sd">    :type bright: float</span>


<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bright</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">GaussianSpectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">PhotopicPeak</span><span class="p">,</span><span class="n">PhotopicWidth</span><span class="p">,</span><span class="n">bright</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Photopic Spectrum&quot;</span>

    
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The str() function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;b: </span><span class="si">{0:7.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">)</span> </div>

<span class="c1">#</span>
<div class="viewcode-block" id="ScotopicSpectrum"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.ScotopicSpectrum">[docs]</a><span class="k">class</span> <span class="nc">ScotopicSpectrum</span><span class="p">(</span><span class="n">GaussianSpectrum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Scotopic (dark adapted) specral response of the eye</span>

<span class="sd">    :param bright: peak brightness, (Default = 1.0)</span>
<span class="sd">    :type bright: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bright</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">GaussianSpectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ScotopicPeak</span><span class="p">,</span><span class="n">ScotopicWidth</span><span class="p">,</span><span class="n">bright</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Scotopic Spectrum&quot;</span>

    <span class="c1">#</span>
    <span class="c1">#        The __str__ method</span>
    <span class="c1">#</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The str() function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;b: </span><span class="si">{0:7.4f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">)</span> </div>

<span class="c1">#             Tricolour spectrum </span>
<span class="c1">#</span>
<div class="viewcode-block" id="TriColourSpectrum"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.TriColourSpectrum">[docs]</a><span class="k">class</span> <span class="nc">TriColourSpectrum</span><span class="p">(</span><span class="n">Spectrum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">    Implement a three coloured spectrum (RGB), all with same width</span>

<span class="sd">    :param red: the red peak, (default 1.0)</span>
<span class="sd">    :type red: float</span>
<span class="sd">    :param green: the green peak, (default 1.0)</span>
<span class="sd">    :type green: float</span>
<span class="sd">    :param blue: the blue peak, (default 1.0)</span>
<span class="sd">    :type blus: float</span>
<span class="sd">    :param bright: the overall brightness, (default 1.0)</span>
<span class="sd">    :type bright: float</span>
<span class="sd">    :param width: the width of each peak, (default 0.025)</span>
<span class="sd">    :type width: float</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">red</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">,</span><span class="n">green</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">,</span><span class="n">blue</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">,</span><span class="n">bright</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span><span class="n">width</span> <span class="o">=</span> <span class="mf">0.025</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; The tricoloured spectrum</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Spectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">bright</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">red</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">red</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">green</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">green</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">blue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Tricoloured Spectrum&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        str function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;b : </span><span class="si">{0:6.3f}</span><span class="s2"> [</span><span class="si">{1:6.3f}</span><span class="s2">, </span><span class="si">{2:6.3f}</span><span class="s2">, </span><span class="si">{3:6.3f}</span><span class="s2">] w: </span><span class="si">{4:6.3f}</span><span class="s2">&quot;</span><span class="o">.</span>\
            <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">red</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">green</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">blue</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        

    <span class="k">def</span> <span class="nf">__getNewValue__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the new value at specified wavelength</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">-</span> <span class="n">Red</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">red</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">-</span> <span class="n">Green</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">green</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">-</span> <span class="n">Blue</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">brightness</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">blue</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">value</span></div>


<div class="viewcode-block" id="WavelengthColour"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.WavelengthColour">[docs]</a><span class="k">def</span> <span class="nf">WavelengthColour</span><span class="p">(</span><span class="n">wave</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to form as RGB list of floats to represent a wavelength colour.</span>
<span class="sd">    Based on </span>
<span class="sd">    &lt;a href=&quot;http://www.cox-internet.com/ast305/color.html&quot;&gt;fortran code&lt;/a&gt; </span>
<span class="sd">    by Dan Bruton, Stephen F Austin State University.</span>

<span class="sd">    :param wave: wavelnegth in microns</span>
<span class="sd">    :type wave: float</span>
<span class="sd">    :return: hexstring of the colour</span>
<span class="sd"> </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    
    <span class="n">rgb</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]</span>      <span class="c1"># Default to black</span>

    <span class="k">if</span> <span class="n">wave</span> <span class="o">&gt;</span> <span class="mf">0.37</span> <span class="ow">and</span> <span class="n">wave</span> <span class="o">&lt;</span> <span class="mf">0.75</span><span class="p">:</span>     <span class="c1"># there is colour </span>
            
        <span class="c1">#         Take linear multi-point dog-leg</span>
        <span class="k">if</span> <span class="n">wave</span> <span class="o">&lt;</span> <span class="mf">0.44</span><span class="p">:</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.44</span> <span class="o">-</span> <span class="n">wave</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.44</span> <span class="o">-</span> <span class="mf">0.37</span><span class="p">)</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">elif</span> <span class="n">wave</span> <span class="o">&lt;</span> <span class="mf">0.49</span> <span class="p">:</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">wave</span> <span class="o">-</span> <span class="mf">0.44</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.49</span> <span class="o">-</span> <span class="mf">0.44</span><span class="p">)</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">elif</span> <span class="n">wave</span> <span class="o">&lt;</span> <span class="mf">0.51</span><span class="p">:</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.51</span> <span class="o">-</span> <span class="n">wave</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.51</span> <span class="o">-</span> <span class="mf">0.49</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">wave</span> <span class="o">&lt;</span> <span class="mf">0.58</span><span class="p">:</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">wave</span> <span class="o">-</span> <span class="mf">0.51</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.58</span> <span class="o">-</span> <span class="mf">0.51</span><span class="p">)</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">elif</span> <span class="n">wave</span> <span class="o">&lt;</span> <span class="mf">0.645</span> <span class="p">:</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.645</span> <span class="o">-</span> <span class="n">wave</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">0.645</span> <span class="o">-</span> <span class="mf">0.58</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
            
            <span class="c1">#     Now correct for eye</span>

        <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.7</span>                    <span class="c1"># gamma of eye</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">wave</span> <span class="o">-</span> <span class="mf">0.56</span><span class="p">;</span>               <span class="c1"># Distance from peak of vision</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">d</span><span class="o">/</span><span class="mf">0.03610944</span><span class="p">;</span>  <span class="c1"># Parabola with zeros 0.37 &amp; 0.75</span>

        <span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">scale</span><span class="o">*</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gamma</span><span class="p">)</span>     <span class="c1">#Scale by gamma (fit to monitor)</span>
        <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">scale</span><span class="o">*</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">gamma</span><span class="p">)</span>
        <span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">scale</span><span class="o">*</span><span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">gamma</span><span class="p">)</span>

        <span class="n">red</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">255</span><span class="p">))</span>            <span class="c1"># Scale in int 0 -&gt; 255</span>
        <span class="n">green</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">255</span><span class="p">))</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">255</span><span class="p">))</span>
        
        <span class="c1">#       Do a format </span>
        <span class="k">return</span> <span class="s2">&quot;#</span><span class="si">{0:02X}{1:02X}{2:02X}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">red</span><span class="p">,</span><span class="n">green</span><span class="p">,</span><span class="n">blue</span><span class="p">)</span></div>
    


<div class="viewcode-block" id="RefractiveIndexColour"><a class="viewcode-back" href="../../wavelength.html#optics.wavelength.RefractiveIndexColour">[docs]</a><span class="k">def</span> <span class="nf">RefractiveIndexColour</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to form as RGB list of floats to represent a refratcive index colour for diagrams</span>

<span class="sd">    :param index: value of refrative index (Default = 1.5)</span>
<span class="sd">    :type index: float</span>
<span class="sd">    :return: hexstring with colour</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">RefractiveIndex</span><span class="p">):</span>     <span class="c1"># Allow for different parameters</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            
    <span class="n">rgb</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">]</span>      <span class="c1"># Default to grey/blue</span>

    <span class="n">index_min</span> <span class="o">=</span> <span class="mf">1.4</span>
    <span class="n">index_max</span> <span class="o">=</span> <span class="mf">2.3</span>

    <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">index_min</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">index_max</span> <span class="o">-</span> <span class="n">index_min</span><span class="p">)</span>
    <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">delta</span><span class="o">*</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    
    <span class="n">red</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">255</span><span class="p">))</span>            <span class="c1"># Scale in int 0 -&gt; 255</span>
    <span class="n">green</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">255</span><span class="p">))</span>
    <span class="n">blue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">255</span><span class="p">))</span>
        
        <span class="c1">#       Do a format </span>
    <span class="k">return</span> <span class="s2">&quot;#</span><span class="si">{0:02X}{1:02X}{2:02X}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">red</span><span class="p">,</span><span class="n">green</span><span class="p">,</span><span class="n">blue</span><span class="p">)</span></div>




        

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Ray Optics</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tio.html">Terminal Input / Output (tio)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vector.html">Vector Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wavelength.html">Wavelength Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../matrix.html">Matrix Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ray.html">Ray Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../surface.html">Surface Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lens.html">Lens Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../psf.html">Point Spread Functions and Spot Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis.html">Analysis Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wavefront.html">Wavefront analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zernike.html">Zernike analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../material.html">Material Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gui.html">GUI Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jones.html">Jones Methods</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Will Hossack.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>